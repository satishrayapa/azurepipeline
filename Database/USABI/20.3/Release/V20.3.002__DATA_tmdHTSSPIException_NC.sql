-- tmdHTSSPIException inserts/updates
IF EXISTS (select * from dbo.sysobjects where id = object_id(N'[dbo].[tmdHTSSPIException]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
BEGIN  
	IF Object_ID('tempdb..#tmdHTSSPIException') IS NOT NULL DROP TABLE #tmdHTSSPIException
	Declare @StartEffDate As Date 
	Declare @EndEffDate As Date 
	Set @StartEffDate = '4/25/2020'
	Set @EndEffDate = '12/31/9999'
	CREATE TABLE #tmdHTSSPIException (HTSNum VARCHAR(10), SPI VARCHAR(2), CountryCode VARCHAR(2))

	INSERT INTO #tmdHTSSPIException(HTSNum, SPI, CountryCode)  
	VALUES	
	('03022300', 'A*', 'TH'),
	('03024511', 'A*', 'TH'),
	('03024611', 'A*', 'TH'),
	('03025411', 'A*', 'TH'),
	('03025511', 'A*', 'TH'),
	('03025611', 'A*', 'TH'),
	('03025911', 'A*', 'TH'),
	('03027111', 'A*', 'TH'),
	('03027211', 'A*', 'TH'),
	('03027311', 'A*', 'TH'),
	('03027911', 'A*', 'TH'),
	('03028411', 'A*', 'TH'),
	('03028511', 'A*', 'TH'),
	('03028911', 'A*', 'TH'),
	('03029120', 'A*', 'TH'),
	('03033300', 'A*', 'TH'),
	('03033400', 'A*', 'TH'),
	('03033901', 'A*', 'TH'),
	('03035300', 'A*', 'TH'),
	('03038100', 'A*', 'TH'),
	('03039120', 'A*', 'TH'),
	('03046450', 'A*', 'TH'),
	('03049190', 'A*', 'TH'),
	('03049290', 'A*', 'TH'),
	('03049390', 'A*', 'TH'),
	('03049590', 'A*', 'TH'),
	('03049600', 'A*', 'TH'),
	('03049700', 'A*', 'TH'),
	('03049991', 'A*', 'TH'),
	('03051040', 'A*', 'TH'),
	('03052020', 'A*', 'TH'),
	('03056320', 'A*', 'TH'),
	('03056960', 'A*', 'TH'),
	('03061420', 'A*', 'TH'),
	('03063320', 'A*', 'TH'),
	('03069320', 'A*', 'TH'),
	('03076000', 'A*', 'TH'),
	('06011015', 'A*', 'TH'),
	('06011045', 'A*', 'TH'),
	('06011060', 'A*', 'TH'),
	('06011075', 'A*', 'TH'),
	('06011090', 'A*', 'TH'),
	('06012090', 'A*', 'TH'),
	('06021000', 'A*', 'TH'),
	('06031901', 'A*', 'TH'),
	('06039000', 'A*', 'TH'),
	('06049060', 'A*', 'TH'),
	('07108050', 'A*', 'TH'),
	('07108065', 'A*', 'TH'),
	('07108070', 'A*', 'TH'),
	('07108093', 'A*', 'TH'),
	('07115990', 'A*', 'TH'),
	('07139011', 'A*', 'TH'),
	('07139061', 'A*', 'TH'),
	('07139081', 'A*', 'TH'),
	('08111000', 'A*', 'TH'),
	('08112020', 'A*', 'TH'),
	('08112040', 'A*', 'TH'),
	('09022010', 'A*', 'TH'),
	('09101200', 'A*', 'TH'),
	('11061000', 'A*', 'TH'),
	('12077000', 'A*', 'TH'),
	('14049040', 'A*', 'TH'),
	('15155000', 'A*', 'TH'),
	('16041390', 'A*', 'TH'),
	('16041450', 'A*', 'TH'),
	('16041640', 'A*', 'TH'),
	('16041710', 'A*', 'TH'),
	('16041780', 'A*', 'TH'),
	('16041810', 'A*', 'TH'),
	('16041890', 'A*', 'TH'),
	('16041922', 'A*', 'TH'),
	('16041925', 'A*', 'TH'),
	('16041932', 'A*', 'TH'),
	('16041982', 'A*', 'TH'),
	('16042005', 'A*', 'TH'),
	('16043100', 'A*', 'TH'),
	('16051005', 'A*', 'TH'),
	('16051040', 'A*', 'TH'),
	('16053005', 'A*', 'TH'),
	('16055615', 'A*', 'TH'),
	('16055855', 'A*', 'TH'),
	('17023022', 'A*', 'TH'),
	('17029005', 'A*', 'TH'),
	('17029010', 'A*', 'TH'),
	('17029035', 'A*', 'TH'),
	('17029040', 'A*', 'TH'),
	('17029052', 'A*', 'TH'),
	('18069001', 'A*', 'TH'),
	('18069005', 'A*', 'TH'),
	('18069015', 'A*', 'TH'),
	('18069025', 'A*', 'TH'),
	('18069055', 'A*', 'TH'),
	('18069090', 'A*', 'TH'),
	('19021140', 'A*', 'TH'),
	('19021940', 'A*', 'TH'),
	('19022000', 'A*', 'TH'),
	('19023000', 'A*', 'TH'),
	('19043000', 'A*', 'TH'),
	('19059090', 'A*', 'TH'),
	('20051000', 'A*', 'TH'),
	('20052000', 'A*', 'TH'),
	('20055900', 'A*', 'TH'),
	('20057002', 'A*', 'TH'),
	('20057006', 'A*', 'TH'),
	('20057012', 'A*', 'TH'),
	('20057016', 'A*', 'TH'),
	('20057023', 'A*', 'TH'),
	('20057025', 'A*', 'TH'),
	('20057075', 'A*', 'TH'),
	('20059910', 'A*', 'TH'),
	('20059920', 'A*', 'TH'),
	('20059955', 'A*', 'TH'),
	('20059985', 'A*', 'TH'),
	('20059997', 'A*', 'TH'),
	('20079140', 'A*', 'TH'),
	('20079190', 'A*', 'TH'),
	('20083010', 'A*', 'TH'),
	('20083037', 'A*', 'TH'),
	('20083048', 'A*', 'TH'),
	('20083060', 'A*', 'TH'),
	('20083096', 'A*', 'TH'),
	('20085020', 'A*', 'TH'),
	('20089913', 'A*', 'TH'),
	('20089921', 'A*', 'TH'),
	('20089923', 'A*', 'TH'),
	('20089928', 'A*', 'TH'),
	('20089940', 'A*', 'TH'),
	('20089945', 'A*', 'TH'),
	('20089963', 'A*', 'TH'),
	('20089965', 'A*', 'TH'),
	('20089980', 'A*', 'TH'),
	('20089991', 'A*', 'TH'),
	('20098100', 'A*', 'TH'),
	('20098965', 'A*', 'TH'),
	('20098970', 'A*', 'TH'),
	('20098980', 'A*', 'TH'),
	('20099020', 'A*', 'TH'),
	('21012032', 'A*', 'TH'),
	('21012054', 'A*', 'TH'),
	('21012090', 'A*', 'TH'),
	('21022020', 'A*', 'TH'),
	('21022060', 'A*', 'TH'),
	('21031000', 'A*', 'TH'),
	('21033040', 'A*', 'TH'),
	('21069003', 'A*', 'TH'),
	('21069006', 'A*', 'TH'),
	('21069012', 'A*', 'TH'),
	('21069015', 'A*', 'TH'),
	('21069018', 'A*', 'TH'),
	('21069042', 'A*', 'TH'),
	('21069044', 'A*', 'TH'),
	('21069052', 'A*', 'TH'),
	('21069054', 'A*', 'TH'),
	('21069058', 'A*', 'TH'),
	('21069082', 'A*', 'TH'),
	('22029100', 'A*', 'TH'),
	('28112210', 'A*', 'TH'),
	('28220000', 'A*', 'TH'),
	('28259010', 'A*', 'TH'),
	('28259015', 'A*', 'TH'),
	('28259020', 'A*', 'TH'),
	('28259090', 'A*', 'TH'),
	('28322000', 'A*', 'TH'),
	('29109010', 'A*', 'TH'),
	('29109091', 'A*', 'TH'),
	('29181510', 'A*', 'TH'),
	('29181550', 'A*', 'TH'),
	('29182210', 'A*', 'TH'),
	('29182250', 'A*', 'TH'),
	('29183090', 'A*', 'TH'),
	('29224949', 'A*', 'TH'),
	('29224980', 'A*', 'TH'),
	('29232020', 'A*', 'TH'),
	('29319026', 'A*', 'TH'),
	('29319090', 'A*', 'TH'),
	('29389000', 'A*', 'TH'),
	('29400060', 'A*', 'TH'),
	('33071010', 'A*', 'TH'),
	('33071020', 'A*', 'TH'),
	('33074900', 'A*', 'TH'),
	('36030030', 'A*', 'TH'),
	('36030060', 'A*', 'TH'),
	('36030090', 'A*', 'TH'),
	('36049000', 'A*', 'TH'),
	('38086910', 'A*', 'TH'),
	('39073000', 'A*', 'TH'),
	('39123100', 'A*', 'TH'),
	('39162000', 'A*', 'TH'),
	('39173900', 'A*', 'TH'),
	('39204310', 'A*', 'TH'),
	('39204350', 'A*', 'TH'),
	('39206900', 'A*', 'TH'),
	('39209200', 'A*', 'TH'),
	('39211211', 'A*', 'TH'),
	('39211219', 'A*', 'TH'),
	('39211250', 'A*', 'TH'),
	('39211311', 'A*', 'TH'),
	('39211350', 'A*', 'TH'),
	('39241010', 'A*', 'TH'),
	('39241020', 'A*', 'TH'),
	('39241030', 'A*', 'TH'),
	('39241040', 'A*', 'TH'),
	('39252000', 'A*', 'TH'),
	('39253010', 'A*', 'TH'),
	('39253050', 'A*', 'TH'),
	('39264000', 'A*', 'TH'),
	('40091100', 'A*', 'TH'),
	('40092100', 'A*', 'TH'),
	('40093100', 'A*', 'TH'),
	('40094100', 'A*', 'TH'),
	('40103160', 'A*', 'TH'),
	('40118020', 'A*', 'TH'),
	('40118080', 'A*', 'TH'),
	('40119020', 'A*', 'TH'),
	('40119080', 'A*', 'TH'),
	('40169100', 'A*', 'TH'),
	('44091005', 'A*', 'TH'),
	('44092906', 'A*', 'TH'),
	('44121005', 'A*', 'TH'),
	('44123126', 'A*', 'TH'),
	('44123141', 'A*', 'TH'),
	('44123152', 'A*', 'TH'),
	('44123161', 'A*', 'TH'),
	('44123192', 'A*', 'TH'),
	('44123930', 'A*', 'TH'),
	('44123940', 'A*', 'TH'),
	('44129931', 'A*', 'TH'),
	('44129941', 'A*', 'TH'),
	('44129970', 'A*', 'TH'),
	('44129980', 'A*', 'TH'),
	('44129990', 'A*', 'TH'),
	('44140000', 'A*', 'TH'),
	('44170080', 'A*', 'TH'),
	('44189190', 'A*', 'TH'),
	('44189990', 'A*', 'TH'),
	('44191100', 'A*', 'TH'),
	('44191910', 'A*', 'TH'),
	('44191990', 'A*', 'TH'),
	('44199010', 'A*', 'TH'),
	('44199090', 'A*', 'TH'),
	('44201000', 'A*', 'TH'),
	('44209045', 'A*', 'TH'),
	('44209080', 'A*', 'TH'),
	('44219130', 'A*', 'TH'),
	('44219160', 'A*', 'TH'),
	('44219197', 'A*', 'TH'),
	('44219930', 'A*', 'TH'),
	('44219960', 'A*', 'TH'),
	('44219997', 'A*', 'TH'),
	('46019305', 'A*', 'TH'),
	('46019320', 'A*', 'TH'),
	('46021105', 'A*', 'TH'),
	('46021109', 'A*', 'TH'),
	('46021145', 'A*', 'TH'),
	('46021205', 'A*', 'TH'),
	('46021216', 'A*', 'TH'),
	('46021223', 'A*', 'TH'),
	('46021245', 'A*', 'TH'),
	('46029000', 'A*', 'TH'),
	('57029130', 'A*', 'TH'),
	('57029210', 'A*', 'TH'),
	('57029905', 'A*', 'TH'),
	('57029920', 'A*', 'TH'),
	('57031020', 'A*', 'TH'),
	('61161008', 'A*', 'TH'),
	('61169935', 'A*', 'TH'),
	('61178085', 'A*', 'TH'),
	('62044910', 'A*', 'TH'),
	('62160008', 'A*', 'TH'),
	('62160035', 'A*', 'TH'),
	('62160046', 'A*', 'TH'),
	('62171085', 'A*', 'TH'),
	('63079085', 'A*', 'TH'),
	('63079098', 'A*', 'TH'),
	('64059020', 'A*', 'TH'),
	('64062000', 'A*', 'TH'),
	('65069930', 'A*', 'TH'),
	('65069960', 'A*', 'TH'),
	('67010030', 'A*', 'TH'),
	('67010060', 'A*', 'TH'),
	('67029010', 'A*', 'TH'),
	('67029035', 'A*', 'TH'),
	('67029065', 'A*', 'TH'),
	('68029200', 'A*', 'TH'),
	('69091140', 'A*', 'TH'),
	('69091200', 'A*', 'TH'),
	('69101000', 'A*', 'TH'),
	('69111015', 'A*', 'TH'),
	('69111025', 'A*', 'TH'),
	('69111035', 'A*', 'TH'),
	('69111037', 'A*', 'TH'),
	('69111038', 'A*', 'TH'),
	('69111041', 'A*', 'TH'),
	('69111045', 'A*', 'TH'),
	('69111060', 'A*', 'TH'),
	('69120010', 'A*', 'TH'),
	('69120035', 'A*', 'TH'),
	('69120041', 'A*', 'TH'),
	('69120046', 'A*', 'TH'),
	('69120048', 'A*', 'TH'),
	('69120050', 'A*', 'TH'),
	('69131020', 'A*', 'TH'),
	('69139050', 'A*', 'TH'),
	('69149080', 'A*', 'TH'),
	('70023900', 'A*', 'TH'),
	('70139930', 'A*', 'TH'),
	('70139935', 'A*', 'TH'),
	('70199050', 'A*', 'TH'),
	('71131910', 'A*', 'TH'),
	('71131921', 'A*', 'TH'),
	('71131925', 'A*', 'TH'),
	('71131929', 'A*', 'TH'),
	('71131930', 'A*', 'TH'),
	('71132010', 'A*', 'TH'),
	('71132021', 'A*', 'TH'),
	('71132025', 'A*', 'TH'),
	('71132029', 'A*', 'TH'),
	('71132030', 'A*', 'TH'),
	('71132050', 'A*', 'TH'),
	('71142000', 'A*', 'TH'),
	('71162005', 'A*', 'TH'),
	('71162015', 'A*', 'TH'),
	('71162030', 'A*', 'TH'),
	('71162035', 'A*', 'TH'),
	('71162040', 'A*', 'TH'),
	('71171100', 'A*', 'TH'),
	('71179020', 'A*', 'TH'),
	('71179030', 'A*', 'TH'),
	('71179055', 'A*', 'TH'),
	('71179090', 'A*', 'TH'),
	('73071100', 'A*', 'TH'),
	('73071930', 'A*', 'TH'),
	('73072900', 'A*', 'TH'),
	('73079360', 'A*', 'TH'),
	('73079390', 'A*', 'TH'),
	('73181560', 'A*', 'TH'),
	('73181580', 'A*', 'TH'),
	('73181900', 'A*', 'TH'),
	('73201030', 'A*', 'TH'),
	('73201090', 'A*', 'TH'),
	('73218110', 'A*', 'TH'),
	('73239150', 'A*', 'TH'),
	('73239300', 'A*', 'TH'),
	('73239930', 'A*', 'TH'),
	('73239970', 'A*', 'TH'),
	('73239990', 'A*', 'TH'),
	('73241000', 'A*', 'TH'),
	('74082910', 'A*', 'TH'),
	('74082950', 'A*', 'TH'),
	('74102200', 'A*', 'TH'),
	('74112910', 'A*', 'TH'),
	('74112950', 'A*', 'TH'),
	('74122000', 'A*', 'TH'),
	('74130010', 'A*', 'TH'),
	('74130050', 'A*', 'TH'),
	('74130090', 'A*', 'TH'),
	('74181000', 'A*', 'TH'),
	('74182010', 'A*', 'TH'),
	('74182050', 'A*', 'TH'),
	('76042910', 'A*', 'TH'),
	('76042930', 'A*', 'TH'),
	('76042950', 'A*', 'TH'),
	('76052900', 'A*', 'TH'),
	('76071130', 'A*', 'TH'),
	('76071160', 'A*', 'TH'),
	('76071190', 'A*', 'TH'),
	('76109000', 'A*', 'TH'),
	('76152000', 'A*', 'TH'),
	('78011000', 'A*', 'TH'),
	('79070010', 'A*', 'TH'),
	('79070020', 'A*', 'TH'),
	('79070060', 'A*', 'TH'),
	('81089030', 'A*', 'TH'),
	('81089060', 'A*', 'TH'),
	('82100000', 'A*', 'TH'),
	('82119150', 'A*', 'TH'),
	('82119180', 'A*', 'TH'),
	('82119220', 'A*', 'TH'),
	('82119240', 'A*', 'TH'),
	('82119260', 'A*', 'TH'),
	('82119290', 'A*', 'TH'),
	('82119300', 'A*', 'TH'),
	('82159920', 'A*', 'TH'),
	('82159924', 'A*', 'TH'),
	('82159940', 'A*', 'TH'),
	('82159950', 'A*', 'TH'),
	('83012000', 'A*', 'TH'),
	('83016000', 'A*', 'TH'),
	('83040000', 'A*', 'TH'),
	('83061000', 'A*', 'TH'),
	('83062100', 'A*', 'TH'),
	('83063000', 'A*', 'TH'),
	('84022000', 'A*', 'TH'),
	('84041000', 'A*', 'TH'),
	('84042000', 'A*', 'TH'),
	('84049000', 'A*', 'TH'),
	('84118180', 'A*', 'TH'),
	('84118280', 'A*', 'TH'),
	('84133010', 'A*', 'TH'),
	('84133090', 'A*', 'TH'),
	('84139110', 'A*', 'TH'),
	('84145930', 'A*', 'TH'),
	('84145965', 'A*', 'TH'),
	('84148090', 'A*', 'TH'),
	('84149010', 'A*', 'TH'),
	('84196010', 'A*', 'TH'),
	('84199095', 'A*', 'TH'),
	('84221100', 'A*', 'TH'),
	('84431600', 'A*', 'TH'),
	('84483100', 'A*', 'TH'),
	('84501200', 'A*', 'TH'),
	('84509020', 'A*', 'TH'),
	('84509040', 'A*', 'TH'),
	('84509060', 'A*', 'TH'),
	('84512900', 'A*', 'TH'),
	('84571000', 'A*', 'TH'),
	('84581100', 'A*', 'TH'),
	('84589110', 'A*', 'TH'),
	('84589150', 'A*', 'TH'),
	('84601200', 'A*', 'TH'),
	('84603900', 'A*', 'TH'),
	('84615040', 'A*', 'TH'),
	('84615080', 'A*', 'TH'),
	('84623100', 'A*', 'TH'),
	('84623900', 'A*', 'TH'),
	('84624100', 'A*', 'TH'),
	('84661001', 'A*', 'TH'),
	('84669250', 'A*', 'TH'),
	('84669330', 'A*', 'TH'),
	('84669353', 'A*', 'TH'),
	('84669375', 'A*', 'TH'),
	('84669398', 'A*', 'TH'),
	('84669465', 'A*', 'TH'),
	('84669485', 'A*', 'TH'),
	('84671910', 'A*', 'TH'),
	('84771090', 'A*', 'TH'),
	('84772000', 'A*', 'TH'),
	('84795000', 'A*', 'TH'),
	('84807990', 'A*', 'TH'),
	('84812000', 'A*', 'TH'),
	('84813010', 'A*', 'TH'),
	('84813020', 'A*', 'TH'),
	('84813090', 'A*', 'TH'),
	('84823000', 'A*', 'TH'),
	('84834050', 'A*', 'TH'),
	('84834070', 'A*', 'TH'),
	('84834080', 'A*', 'TH'),
	('84834090', 'A*', 'TH'),
	('84841000', 'A*', 'TH'),
	('85013120', 'A*', 'TH'),
	('85013140', 'A*', 'TH'),
	('85013150', 'A*', 'TH'),
	('85013160', 'A*', 'TH'),
	('85013180', 'A*', 'TH'),
	('85013220', 'A*', 'TH'),
	('85013260', 'A*', 'TH'),
	('85014020', 'A*', 'TH'),
	('85014040', 'A*', 'TH'),
	('85014050', 'A*', 'TH'),
	('85014060', 'A*', 'TH'),
	('85016300', 'A*', 'TH'),
	('85068000', 'A*', 'TH'),
	('85103000', 'A*', 'TH'),
	('85111000', 'A*', 'TH'),
	('85139020', 'A*', 'TH'),
	('85139040', 'A*', 'TH'),
	('85142040', 'A*', 'TH'),
	('85142060', 'A*', 'TH'),
	('85165000', 'A*', 'TH'),
	('85167100', 'A*', 'TH'),
	('85181080', 'A*', 'TH'),
	('85366980', 'A*', 'TH'),
	('85371030', 'A*', 'TH'),
	('85371060', 'A*', 'TH'),
	('85371091', 'A*', 'TH'),
	('85372000', 'A*', 'TH'),
	('85389030', 'A*', 'TH'),
	('85389040', 'A*', 'TH'),
	('85389060', 'A*', 'TH'),
	('85391000', 'A*', 'TH'),
	('85392140', 'A*', 'TH'),
	('85399000', 'A*', 'TH'),
	('85431000', 'A*', 'TH'),
	('85437020', 'A*', 'TH'),
	('85437045', 'A*', 'TH'),
	('85437071', 'A*', 'TH'),
	('85437099', 'A*', 'TH'),
	('85441900', 'A*', 'TH'),
	('86079910', 'A*', 'TH'),
	('86079950', 'A*', 'TH'),
	('87115000', 'A*', 'TH'),
	('87168050', 'A*', 'TH'),
	('89039200', 'A*', 'TH'),
	('89039915', 'A*', 'TH'),
	('89039920', 'A*', 'TH'),
	('89039990', 'A*', 'TH'),
	('90013000', 'A*', 'TH'),
	('90014000', 'A*', 'TH'),
	('90049000', 'A*', 'TH'),
	('90064060', 'A*', 'TH'),
	('90131010', 'A*', 'TH'),
	('90131030', 'A*', 'TH'),
	('90131050', 'A*', 'TH'),
	('90172040', 'A*', 'TH'),
	('90172080', 'A*', 'TH'),
	('90312000', 'A*', 'TH'),
	('90330090', 'A*', 'TH'),
	('92029020', 'A*', 'TH'),
	('92029040', 'A*', 'TH'),
	('92029060', 'A*', 'TH'),
	('92051000', 'A*', 'TH'),
	('92059014', 'A*', 'TH'),
	('92059018', 'A*', 'TH'),
	('92059040', 'A*', 'TH'),
	('92060020', 'A*', 'TH'),
	('92060080', 'A*', 'TH'),
	('92071000', 'A*', 'TH'),
	('92079000', 'A*', 'TH'),
	('92081000', 'A*', 'TH'),
	('92089000', 'A*', 'TH'),
	('92099220', 'A*', 'TH'),
	('92099240', 'A*', 'TH'),
	('92099280', 'A*', 'TH'),
	('92099440', 'A*', 'TH'),
	('92099480', 'A*', 'TH'),
	('92099910', 'A*', 'TH'),
	('92099918', 'A*', 'TH'),
	('92099980', 'A*', 'TH'),
	('94043040', 'A*', 'TH'),
	('94054040', 'A*', 'TH'),
	('94054060', 'A*', 'TH'),
	('94054084', 'A*', 'TH'),
	('94055020', 'A*', 'TH'),
	('94055030', 'A*', 'TH'),
	('94055040', 'A*', 'TH'),
	('95061140', 'A*', 'TH'),
	('95061980', 'A*', 'TH'),
	('95066280', 'A*', 'TH'),
	('95069100', 'A*', 'TH'),
	('95069912', 'A*', 'TH'),
	('95069930', 'A*', 'TH'),
	('95069945', 'A*', 'TH'),
	('95069950', 'A*', 'TH'),
	('95069955', 'A*', 'TH'),
	('95069960', 'A*', 'TH'),
	('95072040', 'A*', 'TH'),
	('95072080', 'A*', 'TH'),
	('95073060', 'A*', 'TH'),
	('95073080', 'A*', 'TH'),
	('95079020', 'A*', 'TH'),
	('95079040', 'A*', 'TH'),
	('95079060', 'A*', 'TH'),
	('95079080', 'A*', 'TH'),
	('96033020', 'A*', 'TH'),
	('96039080', 'A*', 'TH'),
	('96091000', 'A*', 'TH'),
	('96100000', 'A*', 'TH'),
	('96131000', 'A*', 'TH'),
	('96151920', 'A*', 'TH'),
	('96151940', 'A*', 'TH'),
	('96151960', 'A*', 'TH'),
	('96159020', 'A*', 'TH'),
	('96159030', 'A*', 'TH'),
	('96159040', 'A*', 'TH'),
	('96159060', 'A*', 'TH'),
	('96200010', 'A*', 'TH'),
	('96200020', 'A*', 'TH'),
	('96200025', 'A*', 'TH'),
	('96200050', 'A*', 'TH'),
	('96200055', 'A*', 'TH'),
	('96200065', 'A*', 'TH'),
	('96200070', 'A*', 'TH'),
	('38231100', 'A*', 'ID'),
	('87021031', 'A*', 'MK'),
	('44123142', 'A*', 'ID'),
	('44123148', 'A*', 'ID');


	MERGE dbo.tmdHTSSPIException dt
		USING #tmdHTSSPIException te
			ON  dt.HTSNum			= te.HTSNum 		
			AND dt.SPI				= te.SPI
			AND dt.CountryCode	= te.CountryCode		
			AND dt.StartEffDate	= @StartEffDate		
	WHEN NOT MATCHED BY TARGET
			THEN INSERT (EffDate, HTSNum, SPI, CountryCode, StartEffDate, EndEffDate, DeletedFlag, KeepDuringRollback) 
			VALUES (GetDate(), te.HTSNum, te.SPI, te.CountryCode, @StartEffDate, @EndEffDate, 'N', 'N');

	IF OBJECT_ID('tempdb..#tmdHTSSPIException') IS NOT NULL DROP TABLE #tmdHTSSPIException

	Update dbo.tmdHTSSPIException SET EndEffDate = '4/24/2020' WHERE HTSNum = '44121005' and CountryCode = 'ID' and SPI = 'A*'
	Update dbo.tmdHTSSPIException SET EndEffDate = '4/24/2020' WHERE HTSNum = '44123141' and CountryCode = 'ID' and SPI = 'A*'
END
