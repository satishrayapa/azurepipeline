-- tmdhts_Exclusions inserts/updates
IF EXISTS (select * from dbo.sysobjects where id = object_id(N'[dbo].[tmdhts_Exclusions]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
BEGIN  
	IF Object_ID('tempdb..#tmdhts_Exclusions') IS NOT NULL DROP TABLE #tmdhts_Exclusions
	Select * into #tmdhts_Exclusions from dbo.tmdhts_Exclusions where 1 = 2

	INSERT INTO #tmdhts_Exclusions(HTSNum, Exclusion, CountryOfOrigin, StartEffDate, EndEffDate)  
	VALUES	
	('2823000000', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('2940006000', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('4016996010', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('4202923131', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('4205008000', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('4412995105', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('4420908000', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('5208114090', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('5208214090', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('5407922090', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('5516440022', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('5603949090', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('6001920010', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('6003406000', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('6005390080', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('6505008015', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('7321111060', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('7616995150', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('7616995190', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8201100000', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8207907585', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8302500000', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8421230000', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8423810040', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8425490000', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8470900190', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8481803010', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8501404040', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8504408500', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8504409530', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8504409540', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8504409570', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8531909001', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8536698000', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8537109150', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('8544429090', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('9403509042', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('9403608081', '99038840', 'CN', '9/24/2018', '8/7/2020'),
	('9403908041', '99038840', 'CN', '9/24/2018', '8/7/2020');

	MERGE dbo.tmdHTS_Exclusions dt
		USING #tmdHTS_Exclusions te
			ON  dt.HTSNum			= te.HTSNum 		
			AND dt.Exclusion		= te.Exclusion
			AND dt.CountryOfOrigin	= te.CountryOfOrigin		
	WHEN MATCHED
			THEN UPDATE SET
				dt.StartEffDate		= te.StartEffDate
				,dt.EndEffDate		= te.EndEffDate
	WHEN NOT MATCHED BY TARGET
			THEN INSERT (HTSNum, Exclusion, CountryOfOrigin, StartEffDate, EndEffDate) 
			VALUES (te.HTSNum, te.Exclusion, te.CountryOfOrigin, te.StartEffDate, te.EndEffDate);

	IF OBJECT_ID('tempdb..#tmdhts_Exclusions') IS NOT NULL DROP TABLE #tmdhts_Exclusions
END
