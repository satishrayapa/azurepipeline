-- tmdhts_Exclusions inserts/updates
IF EXISTS (select * from dbo.sysobjects where id = object_id(N'[dbo].[tmdhts_Exclusions]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
BEGIN  
	IF Object_ID('tempdb..#tmdhts_Exclusions') IS NOT NULL DROP TABLE #tmdhts_Exclusions
	Select * into #tmdhts_Exclusions from dbo.tmdhts_Exclusions where 1 = 2
	INSERT INTO #tmdhts_Exclusions(HTSNum, Exclusion, CountryOfOrigin, StartEffDate, EndEffDate)  
	VALUES	
	('0304610000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('0508000000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('1207700075', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('1209916090', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('1209918055', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('1209918090', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('1605102059', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2811221000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2907151000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2912193000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2914503000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2915405050', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2917125000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2922298190', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2924211600', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2924297100', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2926904300', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2926904801', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2926905050', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2929905090', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2931903000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2931907000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2934109000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('2934201500', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('3810902000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('3913902090', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('3923109000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('3925900000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('3926904590', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4009110000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4009310000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4009410000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4011901010', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4011902010', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4011908010', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4016910000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4016996050', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4202922000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4202923120', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4202923131', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4202929100', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4202999000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4203104095', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4819100040', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4820102060', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4823700020', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('4823700040', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('5108108000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('5501200000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('5501400000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('5903202000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('6006320080', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('6802911500', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('6802930090', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('6802990060', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('6810990080', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('6815100100', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('6909120000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('6909195095', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('7002102000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('7007190000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('7007211010', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('7009100000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('7308301000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('7309000030', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('7310100010', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('7315201000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('7321901000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('7323999080', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('7324900000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('7326908688', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('7419995010', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('7616995190', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('7907006000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8207502070', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8207506000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8302200000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8302303060', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8302496055', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8302496085', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8409915085', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8409919990', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8413309090', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8414801680', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8425420000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8425490000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8465910064', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8479899499', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8481803055', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8483101030', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8483103050', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8483905090', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8501402040', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8501404040', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8501406040', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8504409550', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8504508000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8507100030', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8511300080', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8512202040', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8525803010', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8527294000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8531200020', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8531200040', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8534000020', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8534000095', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8543709100', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8544429090', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8708103050', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8708295060', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8708704560', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8708706060', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8708806590', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8708915000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8708925000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8708945000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8708947000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8708947550', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8708996890', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8708998180', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8712004800', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8716400000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('8716903000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('9002119000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('9401200000', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('9403200081', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('9403200090', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('9403608081', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('9403896015', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('9403896020', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('9403907080', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('9403908041', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('9405208010', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('9405408200', '99038843', 'CN', '9/24/2018', '8/7/2020'),
	('9405408440', '99038843', 'CN', '9/24/2018', '8/7/2020');
	MERGE dbo.tmdHTS_Exclusions dt
		USING #tmdHTS_Exclusions te
			ON  dt.HTSNum			= te.HTSNum 		
			AND dt.Exclusion		= te.Exclusion
			AND dt.CountryOfOrigin	= te.CountryOfOrigin		
	WHEN MATCHED
			THEN UPDATE SET
				dt.StartEffDate		= te.StartEffDate
				,dt.EndEffDate		= te.EndEffDate
	WHEN NOT MATCHED BY TARGET
			THEN INSERT (HTSNum, Exclusion, CountryOfOrigin, StartEffDate, EndEffDate) 
			VALUES (te.HTSNum, te.Exclusion, te.CountryOfOrigin, te.StartEffDate, te.EndEffDate);
	IF OBJECT_ID('tempdb..#tmdhts_Exclusions') IS NOT NULL DROP TABLE #tmdhts_Exclusions
END