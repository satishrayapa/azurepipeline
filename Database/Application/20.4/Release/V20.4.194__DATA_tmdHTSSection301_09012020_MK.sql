-- tmdhts_section301 inserts/updates
IF EXISTS (select * from dbo.sysobjects where id = object_id(N'[dbo].[tmdhts_section301]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
BEGIN  
	IF Object_ID('tempdb..#tmdhts_section301') IS NOT NULL DROP TABLE #tmdhts_section301
	SELECT * INTO #tmdhts_section301 FROM dbo.tmdhts_section301 WHERE 1 = 2

	INSERT INTO #tmdhts_section301(htsnum, status, Chapter99, CountryofOrigin, StartEffDate, EndEffDate, AdvaloremRate, List) 
	VALUES	
	('1905310021','EU Tariffs 84 FR 54245','99038937','DE','9/1/2020','12/31/9999',0.25,0),
('1905310029','EU Tariffs 84 FR 54245','99038937','DE','9/1/2020','12/31/9999',0.25,0),
('1905310041','EU Tariffs 84 FR 54245','99038937','DE','9/1/2020','12/31/9999',0.25,0),
('1905310049','EU Tariffs 84 FR 54245','99038937','DE','9/1/2020','12/31/9999',0.25,0),
('2007990500','EU Tariffs 84 FR 54245','99038952','FR','9/1/2020','12/31/9999',0.25,0),
('2007991000','EU Tariffs 84 FR 54245','99038952','FR','9/1/2020','12/31/9999',0.25,0),
('2007991500','EU Tariffs 84 FR 54245','99038952','FR','9/1/2020','12/31/9999',0.25,0),
('2007992000','EU Tariffs 84 FR 54245','99038952','FR','9/1/2020','12/31/9999',0.25,0),
('2007992500','EU Tariffs 84 FR 54245','99038952','FR','9/1/2020','12/31/9999',0.25,0),
('2007993500','EU Tariffs 84 FR 54245','99038952','FR','9/1/2020','12/31/9999',0.25,0),
('2007996000','EU Tariffs 84 FR 54245','99038952','FR','9/1/2020','12/31/9999',0.25,0),
('2007990500','EU Tariffs 84 FR 54245','99038952','DE','9/1/2020','12/31/9999',0.25,0),
('2007991000','EU Tariffs 84 FR 54245','99038952','DE','9/1/2020','12/31/9999',0.25,0),
('2007991500','EU Tariffs 84 FR 54245','99038952','DE','9/1/2020','12/31/9999',0.25,0),
('2007992000','EU Tariffs 84 FR 54245','99038952','DE','9/1/2020','12/31/9999',0.25,0),
('2007992500','EU Tariffs 84 FR 54245','99038952','DE','9/1/2020','12/31/9999',0.25,0),
('2007993500','EU Tariffs 84 FR 54245','99038952','DE','9/1/2020','12/31/9999',0.25,0),
('2007996000','EU Tariffs 84 FR 54245','99038952','DE','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','AT','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','BE','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','BG','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','HR','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','CY','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','CZ','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','DK','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','EE','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','FI','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','DE','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','HU','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','IE','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','IT','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','LV','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','LT','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','LU','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','MT','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','NL','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','PT','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','RO','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','SK','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','SI','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','ES','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','SE','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038955','GB','9/1/2020','12/31/9999',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','AT','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','BE','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','BG','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','CY','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','CZ','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','DE','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','DK','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','EE','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','ES','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','FI','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','GB','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','GR','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','HR','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','HU','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','IE','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','IT','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','LT','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','LU','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','LV','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','MT','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','NL','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','PT','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','RO','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','SE','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','SI','10/18/2019','8/31/2020',0.25,0),
('0406909900','EU Tariffs 84 FR 54245','99038916','SK','10/18/2019','8/31/2020',0.25,0),
('1905310021','EU Tariffs 84 FR 54245','99038943','DE','10/18/2019','8/31/2020',0.25,0),
('1905310021','EU Tariffs 84 FR 54245','99038943','GB','10/18/2019','8/31/2020',0.25,0),
('1905310029','EU Tariffs 84 FR 54245','99038943','DE','10/18/2019','8/31/2020',0.25,0),
('1905310029','EU Tariffs 84 FR 54245','99038943','GB','10/18/2019','8/31/2020',0.25,0),
('1905310041','EU Tariffs 84 FR 54245','99038943','DE','10/18/2019','8/31/2020',0.25,0),
('1905310041','EU Tariffs 84 FR 54245','99038943','GB','10/18/2019','8/31/2020',0.25,0),
('1905310049','EU Tariffs 84 FR 54245','99038943','DE','10/18/2019','8/31/2020',0.25,0),
('1905310049','EU Tariffs 84 FR 54245','99038943','GB','10/18/2019','8/31/2020',0.25,0)



	MERGE dbo.tmdhts_section301 dt
		USING #tmdhts_section301 te
			ON  dt.htsnum			= te.htsnum		
			AND dt.Chapter99		= te.Chapter99
			AND dt.CountryofOrigin	= te.CountryofOrigin
			AND dt.StartEffDate	    = te.StartEffDate
			AND dt.EndEffDate	    = te.EndEffDate
		
	WHEN NOT MATCHED BY TARGET
			THEN INSERT (htsnum, status, Chapter99, CountryofOrigin, StartEffDate, EndEffDate, AdvaloremRate, List) 
			VALUES (te.htsnum, te.status, te.Chapter99, te.CountryofOrigin, te.StartEffDate, te.EndEffDate, te.AdvaloremRate, te.List);

	IF OBJECT_ID('tempdb..#tmdhts_section301') IS NOT NULL DROP TABLE #tmdhts_section301

END
