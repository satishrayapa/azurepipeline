-- tmdhts_Exclusions updates
IF EXISTS (select * from dbo.sysobjects where id = object_id(N'[dbo].[tmdhts_Exclusions]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
BEGIN  
	IF Object_ID('tempdb..#tmdhts_Exclusions') IS NOT NULL DROP TABLE #tmdhts_Exclusions
	Select * into #tmdhts_Exclusions from dbo.tmdhts_Exclusions where 1 = 2

	INSERT INTO #tmdhts_Exclusions(HTSNum, Exclusion, CountryOfOrigin, StartEffDate, EndEffDate)  
	VALUES	
	('0511910090','99038848','CN','2018-09-24','2020-08-07'),
	('0713331040','99038848','CN','2018-09-24','2020-08-07'),
	('0713501000','99038848','CN','2018-09-24','2020-08-07'),
	('1207700020','99038848','CN','2018-09-24','2020-08-07'),
	('1207700040','99038848','CN','2018-09-24','2020-08-07'),
	('1209300090','99038848','CN','2018-09-24','2020-08-07'),
	('1209916010','99038848','CN','2018-09-24','2020-08-07'),
	('1209918010','99038848','CN','2018-09-24','2020-08-07'),
	('1209918020','99038848','CN','2018-09-24','2020-08-07'),
	('1209918040','99038848','CN','2018-09-24','2020-08-07'),
	('1209918050','99038848','CN','2018-09-24','2020-08-07'),
	('1209918060','99038848','CN','2018-09-24','2020-08-07'),
	('1209918070','99038848','CN','2018-09-24','2020-08-07'),
	('1212290000','99038848','CN','2018-09-24','2020-08-07'),
	('2841690010','99038848','CN','2018-09-24','2020-08-07'),
	('2849901000','99038848','CN','2018-09-24','2020-08-07'),
	('2916191000','99038848','CN','2018-09-24','2020-08-07'),
	('3213100000','99038848','CN','2018-09-24','2020-08-07'),
	('3401305000','99038848','CN','2018-09-24','2020-08-07'),
	('3404905150','99038848','CN','2018-09-24','2020-08-07'),
	('3801105000','99038848','CN','2018-09-24','2020-08-07'),
	('3808935050','99038848','CN','2018-09-24','2020-08-07'),
	('3824780020','99038848','CN','2018-09-24','2020-08-07'),
	('3824999297','99038848','CN','2018-09-24','2020-08-07'),
	('4016935020','99038848','CN','2018-09-24','2020-08-07'),
	('4016996050','99038848','CN','2018-09-24','2020-08-07'),
	('4202221500','99038848','CN','2018-09-24','2020-08-07'),
	('4202321000','99038848','CN','2018-09-24','2020-08-07'),
	('4202923131','99038848','CN','2018-09-24','2020-08-07'),
	('4411132000','99038848','CN','2018-09-24','2020-08-07'),
	('4420908000','99038848','CN','2018-09-24','2020-08-07'),
	('4421991500','99038848','CN','2018-09-24','2020-08-07'),
	('4602900000','99038848','CN','2018-09-24','2020-08-07'),
	('4820102010','99038848','CN','2018-09-24','2020-08-07'),
	('4820500000','99038848','CN','2018-09-24','2020-08-07'),
	('5603149090','99038848','CN','2018-09-24','2020-08-07'),
	('5603920090','99038848','CN','2018-09-24','2020-08-07'),
	('5603930090','99038848','CN','2018-09-24','2020-08-07'),
	('5701901010','99038848','CN','2018-09-24','2020-08-07'),
	('5901904000','99038848','CN','2018-09-24','2020-08-07'),
	('7308400000','99038848','CN','2018-09-24','2020-08-07'),
	('7310100010','99038848','CN','2018-09-24','2020-08-07'),
	('7310210025','99038848','CN','2018-09-24','2020-08-07'),
	('7318158082','99038848','CN','2018-09-24','2020-08-07'),
	('7321111060','99038848','CN','2018-09-24','2020-08-07'),
	('7321901000','99038848','CN','2018-09-24','2020-08-07'),
	('7326908688','99038848','CN','2018-09-24','2020-08-07'),
	('7616995190','99038848','CN','2018-09-24','2020-08-07'),
	('8207193060','99038848','CN','2018-09-24','2020-08-07'),
	('8302494000','99038848','CN','2018-09-24','2020-08-07'),
	('8303000000','99038848','CN','2018-09-24','2020-08-07'),
	('8412909081','99038848','CN','2018-09-24','2020-08-07'),
	('8418500080','99038848','CN','2018-09-24','2020-08-07'),
	('8421230000','99038848','CN','2018-09-24','2020-08-07'),
	('8423810040','99038848','CN','2018-09-24','2020-08-07'),
	('8426300000','99038848','CN','2018-09-24','2020-08-07'),
	('8481809015','99038848','CN','2018-09-24','2020-08-07'),
	('8512202040','99038848','CN','2018-09-24','2020-08-07'),
	('8512902000','99038848','CN','2018-09-24','2020-08-07'),
	('8516604074','99038848','CN','2018-09-24','2020-08-07'),
	('8531909001','99038848','CN','2018-09-24','2020-08-07'),
	('8708295060','99038848','CN','2018-09-24','2020-08-07'),
	('9401790050','99038848','CN','2018-09-24','2020-08-07'),
	('9403608081','99038848','CN','2018-09-24','2020-08-07'),
	('9403704002','99038848','CN','2018-09-24','2020-08-07');


	MERGE dbo.tmdHTS_Exclusions dt
		USING #tmdHTS_Exclusions te
			ON  dt.HTSNum			= te.HTSNum 		
			AND dt.Exclusion		= te.Exclusion
			AND dt.CountryOfOrigin	= te.CountryOfOrigin		
	WHEN MATCHED
			THEN UPDATE SET
				dt.StartEffDate		= te.StartEffDate
				,dt.EndEffDate		= te.EndEffDate
	WHEN NOT MATCHED BY TARGET
			THEN INSERT (HTSNum, Exclusion, CountryOfOrigin, StartEffDate, EndEffDate) 
			VALUES (te.HTSNum, te.Exclusion, te.CountryOfOrigin, te.StartEffDate, te.EndEffDate);

	IF OBJECT_ID('tempdb..#tmdhts_Exclusions') IS NOT NULL DROP TABLE #tmdhts_Exclusions
END
